<!DOCTYPE HTML>
<html>
<head>
    <title>Getting Started: Serving Web Content</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <style>
        #error {
            color: red;
        }
    </style>
</head>
<body>
<div>
    <h2>Добавление карты</h2>
    <div id="error">{{error}}</div>
    <form method="post">
        <input type="text" required name="number" placeholder="Номер">
        <input type="text" required name="holder" placeholder="Держатель">
        <input type="date" required name="issueDate" placeholder="Дата выдачи">
        <button type="submit">Добавить карту</button>
    </form>
</div>
<hr>
<h2>Список карт</h2>
    {{#cards}}
        <p>
            <b>{{number}}</b>
            <i>{{holder}}</i>
            <span class="issue">{{issueDate}}</span>
            <button class="steal">Списать деньги</button>
        </p>
    {{/cards}}
<script>
    var stealList = document.getElementsByClassName('steal');

    for (var i = 0; i < stealList.length; i++) {
        stealList[i].addEventListener('click', event);
    }

    function event(){
        var cardDate = this.previousElementSibling.innerText;
        validateDate(cardDate);
    }

    function validateDate(value) {
        var arrD = value.split("-");
        arrD[1] -= 1;
        var date = new Date(arrD[0], arrD[1], arrD[2]);
        if (date > new Date()) {
            alert('Деньги Списаны! Карта актвная до ' + date);
        } else {
            alert('Ссори, карта просрочена ' + date);
        }
    }
</script>
</body>
</html>